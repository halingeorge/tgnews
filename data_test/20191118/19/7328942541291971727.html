<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://interestingengineering.com/new-algorithm-removes-underwater-distortions-for-clear-colorful-pictures"/>
    <meta property="og:site_name" content="Interesting Engineering"/>
    <meta property="article:published_time" content="2019-11-18T19:55:00+00:00"/>
    <meta property="og:title" content="New Algorithm Removes Underwater Distortions for Clear Colorful Pictures"/>
    <meta property="og:description" content="Its integration to your photo editing software, camera, and even to your diving mask is only a matter of time."/>
  </head>
  <body>
    <article>
      <h1>New Algorithm Removes Underwater Distortions for Clear Colorful Pictures</h1>
      <h2>The new system is being praised by marine life researchers.</h2>
      <address><time datetime="2019-11-18T19:55:00+00:00">18 Nov 2019, 19:55</time> by <a rel="author">Loukia Papadopoulos</a></address>
      <p>Have you ever taken an underwater picture only to have it come out in hues of green and blue? That is because light behaves differently in water.</p>
      <figure>
        <iframe src="https://www.youtube.com/embed/ExOOElyZ2Hk" width="640" height="360" data-service="Youtube" scrolling="no"/>
      </figure>
      <p>Although it may just be a bummer when taking personal pics, the phenomenon is actually a bigger deal in the scientific community where the inability to take accurate pictures of sea life is hindering essential progress. Now Oceanographer and engineer Derya Akkaynak and engineer Tali Treibitz, of the University of Haifa, <a href="http://openaccess.thecvf.com/content_CVPR_2019/papers/Akkaynak_Sea-Thru_A_Method_for_Removing_Water_From_Underwater_Images_CVPR_2019_paper.pdf">have created</a> a new artificial intelligence <a href="http://openaccess.thecvf.com/content_CVPR_2019/papers/Akkaynak_Sea-Thru_A_Method_for_Removing_Water_From_Underwater_Images_CVPR_2019_paper.pdf">algorithm</a> that may just solve all that.</p>
      <figure>
        <iframe data-src="https://twitter.com/dakkaynak/status/1139580118790262785?ref_src=twsrc%5Etfw" data-embed-type="twitter-tweet" width="100%" height="0" data-service="Twitter" scrolling="no" nowide=""/>
      </figure>
      <h3>Removing water</h3>
      <p>The best way to describe what the algorithm does is to say it removes the water. This is because it allows pictures to be captured underwater as if they were taken on dry land.</p>
      <p>The researchers have called their new system Sea-thru and it is nothing short of extraordinary. Unlike photoshop that artificially fixes pictures, Sea-thru is a real-time physically accurate correction.</p>
      <p>This image shared in the researchers work truly shows what the algorithm can achieve:</p>
      <figure>
        <img src="https://inteng-storage.s3.amazonaws.com/img/iea/4N61a78b6J/sizes/sea-thru_resize_md.jpg"/>
        <figcaption>
          <i>Source: <a href="http://openaccess.thecvf.com/content_CVPR_2019/papers/Akkaynak_Sea-Thru_A_Method_for_Removing_Water_From_Underwater_Images_CVPR_2019_paper.pdf">Derya Akkaynak</a></i>
        </figcaption>
      </figure>
      <h3>Obtaining true colors</h3>
      <p>
        <a href="https://interestingengineering.com/nvidia-ai-makes-artists-out-of-everyone">
          <b>RELATED: NVIDIA AI MAKES ARTISTS OUT OF EVERYONE</b>
        </a>
      </p>
      <p>The algorithm has gotten the marine life scientific community excited. “What I like about this approach is that it's really about obtaining true colors,” Pim Bongaerts, a coral biologist at the California Academy of Sciences told <a href="https://www.scientificamerican.com/article/sea-thru-brings-clarity-to-underwater-photos1/"><i>Scientific American</i></a>. “Getting true color could really help us get a lot more worth out of our current data sets.”</p>
      <figure>
        <img src="https://inteng-storage.s3.amazonaws.com/img/iea/4N61a78b6J/sizes/untitled-design_resize_md.png"/>
        <figcaption>Source: <i>Matan Yuval</i></figcaption>
      </figure>
      <p>IE had the opportunity to interview Akkaynak on her work.</p>
      <p><b>IE:</b> How did you go about inventing the algorithm?<br/><b>Akkaynak:</b> I developed the Sea-thru algorithm during my post-doctoral fellowship at the University of Haifa, Marine Imaging Lab, as a result of three years of theoretical and experimental work. Digital cameras (along with underwater housings) have been commercially available really only since the early 1990s, so since then consistently correcting colors in underwater images had been a challenging and open problem in our field. That was the problem I started working on in 2015 when I first joined the University of Haifa.</p>
      <figure>
        <img src="https://inteng-storage.s3.amazonaws.com/img/iea/4N61a78b6J/sizes/untitled-design1_resize_md.png"/>
        <figcaption>Source: <i>Matan Yuval</i></figcaption>
      </figure>
      <p>In time, the reasons for the lack of a robust and consistent color correction algorithm became clear -- researchers were using an equation describing how light moves in the atmosphere to produce an image on the camera sensor, to correct colors in underwater photographs. What happens to light underwater is very different than what happens to it in the air. Once I discovered that I formulated a (more) physically accurate equation specifically for the ocean, and that equation is the real breakthrough that led to the Sea-thru algorithm. That equation is why the Sea-thru algorithm works better than existing algorithms, and has been able to produce the stunning corrections (algorithmically) that you have seen.</p>
      <figure>
        <img src="https://inteng-storage.s3.amazonaws.com/img/iea/4N61a78b6J/sizes/untitled-design2_resize_md.png"/>
        <figcaption>Source: <i>Matan Yuval</i></figcaption>
      </figure>
      <p><b>IE:</b> How does the algorithm work?<br/><b>Akkaynak:</b> The only non-standard piece of information it requires is a ‘distance map’ – which<br/>tells us the distance of each object in the scene from the camera. Other than that, it works on raw RGB images taken under natural light. It does not need a color chart in the images. It is not an AI algorithm – so there are no neural networks, or training involved, either.</p>
      <figure>
        <img src="https://inteng-storage.s3.amazonaws.com/img/iea/4N61a78b6J/sizes/untitled-design3_resize_md.png"/>
        <figcaption>Source: <i>Derya Akkaynak</i></figcaption>
      </figure>
      <p>There are different ways of obtaining a distance map. We estimate it utilizing multiple images of the scene. You can also use a stereo camera setup, and obtain distance from a single image pair, not needing multiple images. Once the algorithm has distance, it estimates all the necessary parameters for removing the “fog” and restoring colors based on the equation I mentioned above.</p>
      <figure>
        <img src="https://inteng-storage.s3.amazonaws.com/img/iea/4N61a78b6J/sizes/untitled-design4_resize_md.png"/>
        <figcaption>Source: <i>Derya Akkaynak</i></figcaption>
      </figure>
      <p><b>IE:</b> What applications do you foresee for the algorithm?<br/><b>Akkaynak</b><i><b>:</b> </i>Sea-thru already works on video, which is very cool, because takes away the need for multiple images since video frames inherently are multiple images of the same scene. Also, it takes away the need to carry artificial lights, which means less expense and gear to carry for many photographers.</p>
      <p>But where it will add tremendous value will be the automation of the analysis images and video taken by marine scientists. When these images (eg, surveys of reefs, seafloor, fish stocks, etc) are preprocessed with Sea-thru, scientists will then be able to use powerful computer vision and machine learning methods to be able to count, identify, segment, and classify animals and other objects in them. Currently, we acquire vast amounts of images, but the majority of analyses are done manually, which is tedious, slow, and expensive.</p>
      <figure>
        <img src="https://inteng-storage.s3.amazonaws.com/img/iea/4N61a78b6J/sizes/untitled-design5_resize_md.png"/>
        <figcaption>Source: <i>Derya Akkaynak</i></figcaption>
      </figure>
      <p>At the moment Sea-thru works only on images taken under natural light, but we will extend it to the case of artificial light as that’s how the majority of the ocean is explored. And of course, I see it as a module in Photoshop, integrated into consumer cameras, and even diving masks. It’s only a matter of time!</p>
    </article>
  </body>
</html>